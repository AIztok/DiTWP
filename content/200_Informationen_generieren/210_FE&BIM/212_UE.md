---
title: 212_Uebung
draft: false
tags:
  - "#FEM"
  - "#BIM"
---
# Was lernen wir?

- aus Geometriemodell das analytische Modell ableiten
- Export / Import Excel Datei und mit Speckle Dienst
- wir erstellen ein Stabmodell für den Halbrahmen
- wir ermitteln die Schnittgrößen für den Halbrahmen
- wir ergänzen noch fehlende Berechnungsschritte die nicht im Grasshopper als Sofistik Komponenten existieren 

# Aus Geometriemodell das analytische Modell ableiten

In der [[112_UE]] wurde ein 3D geometrisches Modell erstellt. 
Wir wollen jedoch für die Berechnung der Schnittgrößen der Konstruktion, das Bauwerk auf ein Stabmodell abstrahieren.
Dafür ist es notwendig ein s.g. analytisches Modell abzuleiten.

# Analytisches Modell ableiten

## BREPs zerlegen in Einzelteile

Wir sammeln die zwei BREPs in einem Datenkontainer und zerlegen dann diesen in die Einzelteile (Flächen, Linien, Punkte):

- `BREP` - als Datenkontainer für beider generierten BREPs (mit Flatten - siehe unten oder hier [[013_Grasshopper#Flatten]])
- `Deconstruct BREP` - um die Breps zu zerlegen in Einzelteile

![[Pasted image 20240901131146.png]]

Mit einem Rechtclick auf die Komponente kann die aufbereitung der Listen gesteuert werden. 
Z.B. mit Flatten wird der Baum (jeder BREP im einzelnen Baum) in einen Baum {0} verschoben

![[212_UE_GH_Flatten.png]]

## Linie im Schwerpunkt erstellen

Aus den Punkten der zerlegten BREPs bilden wir eine Linie in der Schwerpunktachse:

- `Fit Line` - für die Sammlung von Punkte bildet es eine Linie im "Schwerpunkt" der Punkte
- `Explode` - diese Linie wird dann explodiert in die Einzelteile (Punkt und Linien)
- `List Item` - wir wählen separat aus die Linie für die Decke bzw. die Wand

![[Pasted image 20240901131338.png]]

## Verschnitt Punkt der zwei Linien finden

Es fehlt uns nun ein Punkt, wo sich theoretisch die Linie der Decke und der Wand verschneiden würden:

- `Line / Line` - findet den Verschnittpunkt der zwei Linien - auch wenn die Linien sich nicht tatsächlich überschneiden sondern Ihre Verlängerung
- `Point` - danach sammeln wir alle Punkte im Datenkontainer

![[Pasted image 20240901131408.png]]

Verschnittpunkt:

![[Pasted image 20240901131434.png]]

# Export der Punktdaten in Excel Format

Damit wir den Workflow zeigen und auch das Modell von der .3dm Datei (Bild und gezeichnete Rechtecke aus der 1. Übung [[112_UE]]) zu trennen, werden wir die Geometrie exportieren in eine .xlsx Datei.

Um die Daten in .xlsx Dateiformat zu exportieren und später importieren, werden wir die Komponente vom TT-Toolbox verwenden.

Sollte bei der Übung die Installation nicht funktionieren oder andere Probleme geben, kann die Excel Datei heruntergeladen werden [[212_UE#Excel File mit den Punkten]].

## Export in Excel

Um die Punkte in eine Excel Datei zu exportieren gehen wie folgend vor:
- `Write to Excel classic` - Komponente aus der TT-Toolbox
- `Panel` - in den Panels definieren wir den Ort wohin wir die Excel Datei speichern wollen und in welches Arbeitsblatt (z.B. Tabelle 1) - wir nutzen hier `Concatenate` um zwei Strings (Ordner und Dateiname) separat zu definieren und zusammenzuführen
- `Boolean Toggle` - der boolische Schalter ist nur ein True / False, womit wir definieren ob die Funktion ausgeführt werden soll (True) und ob die existierenden Ergebnisse gelöscht werden sollen (False)

Wenn wir danach ein Panel anschließen, sehen wir, dass in den Zellen A1 bis E1 jetzt werden für die 5 Punkte gespeichert sein sollten - grundsätzlich sollte sich beim Ausführen auch das Excel öffnen. 

![[212_UE_Export_Excel.png]]

Es wird somit eine .xlsx Datei mit folgenden Inhalt gespeichert (Hinweis: manchmal ist es notwendig eine leere Excel Datei mit gleichen Namen vorab zu erstellen):

<iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRfg0NANCaENZgN0bF01Z3zZYffYSIEtmzoIUA7ZUA6hdTTENOeoz1QWtdLMcHVzA/pubhtml?widget=true&amp;headers=false"></iframe>

Die Excel Datei könnte danach beliebig angepasst werden oder mit anderen geteilt werden. 
# Export der Daten des analytischen Modells (Punkte und Linien) auf Speckle 

Alternativ können wir das Modell auch über den Speckle Dienst teilen, der Vorteil wäre:
- es werden Linien und Punkte gleich exportiert
- es gibt eine interne Versionierung, also es werden bei mehrfachen Export Daten immer gespeichert und nicht überschrieben
- die exportierten Daten können im Browser visualisiert werden

Dafür ist es notwendig aber einen Account zu haben (siehe [[321_Speckle#Installieren]]) und bereits installierten Connector für Grasshopper.

## Beim Speckle Dienst Modell erstellen

Schritt 1: New Model - wir erstellen z.B. 212_ue
Schritt 2: bei 212_ue auf `...` gehen und "Copy link"

![[212_UE_Export_speckle.png]]

Mit "Copy link" wird ein Pfad erstellt, womit wir eine Verbindung zum Modell aufbauen können.
![[212_UE_speckle_copy_link.png|300]]

## Modell im Grasshopper mit Speckle stream verbinden

Wir verbinden die Punkte und Linien einfach mit einem Datenkontainer (`Data` ) und mit der Komponente `Send` von Speckle, danach Send auswählen:

![[212_UE_speckle_gh_send.png]]

Auf Speckle sollte das Modell danach sichtbar sein:

![[212_UE_speckle_model.png]]

Rechts oben im Browser kann auch der Link kopiert werden und mit anderen geteilt werden, bzw. das Modell kann in Grasshopper eingeladen werden:

> https://app.speckle.systems/projects/eba1405a21/models/84e2ea49f8

![[212_UE_speckle_share_link.png|300]]

<iframe title="Speckle" src="https://app.speckle.systems/projects/eba1405a21/models/84e2ea49f8#embed=%7B%22isEnabled%22%3Atrue%7D" width="600" height="400" frameborder="0"></iframe>

# Stabmodell erstellen



# Definition der Lasten

## Eigengewicht

Für das Eigengewicht benötigen wir keine Kraft angeben, nur die Linien auswählen und die Lastfallnummer. Der Faktor für Eigengewicht wird später definiert, siehe [[212_UE#Lastfall Attribute]].

![[Pasted image 20240617222943.png]]


## Veränderliche Lasten

### Nutzlast
Die Nutzlast wird als eine Punktlast mit 50 kN, die am Knoten 2 wirkt wie folgend definiert, wir beziehen uns dabei auf die Liste der Punkte:

![[Pasted image 20240617223046.png]]

### Schneelast
Die Schneelast wird als eine Linienlast aufgebracht, dabei können mehrere Linien ausgewählt werden:

![[Pasted image 20240617223112.png]]

### Windlast
Ähnlich auch die Windlast, jedoch wirkend auf die Linie 1 und in X Richtung:

![[Pasted image 20240617223123.png]]

## Lastfall Attribute

Die Lastfallnummern werden in den Komponente LC Attributes.
Hier wird auch definiert:
- Einwirkung 
- Faktor für das Eigengewicht
- Bezeichnung

Die Lastfallnummern werden dabei aus den oben angegebenen Lastfallnummern in eine Liste zusammengeführt. In gleicher Reihenfolge sollten die Einwirkungsarten und Faktoren fürs Eigengewicht definiert werden, damit richtig zugewiesen:

![[Pasted image 20240617223303.png]]

## Erstellung SOFiLOAD Input

Die Einzellastfälle und die Lastfall Attribute werden mit der Komponente SOFiLOAD verbunden um den Input für das Modul SOFiLOAD zu erstellen:

![[Pasted image 20240617223609.png]]
# Schnittgrößenermittlung

Die 

![[Pasted image 20240617223909.png]]

Die einzelnen Komponenten die den Text Input in Cadinp erstellen, werden mit der SOFiSTiK Project Komponente verbunden. Dabei muss auf die Reihenfolge der anbindung geachtet werden:
1. Material (AQUA)
2. Querschnitte (AQUA)
3. Modell (SOFiMSHC)
4. Lasten (SOFiLOAD)
5. Berechnung (ASE)

![[Pasted image 20240617224035.png]]


1. Öffnen des Ordners
2. Öffnen des erstellten Codes in Teddy (Text Editor)
3. Öffnen der Modellvisualisierung (Animator)
4. Öffnen (Graphics)
5. Öffnen des Berichts (Report Viewer)

Der erstellte Code:

```python
+PROG AQUA
HEAD 'Materialangabe'
PAGE UNII 0
CTRL REST 1

// -------------------------------- User Text -------------------------------------

$----------------------------------------------------------------------------------
!*! Angabe der Norm
NORM OEN en199X-200X unit 0 !
$----------------------------------------------------------------------------------
!*! Umfang der Ausgabe
echo full extr
$----------------------------------------------------------------------------------
!*! Beton
CONC NO 1  TYPE c 30N           titl 'Beton C30/37 Normalerhärtend'
!
$----------------------------------------------------------------------------------
!*! Bewehrung
STEE NO 101 TYPE b 550b titl 'Bewehrung B550B'




END

+PROG AQUA
HEAD
PAGE UNII 0
CTRL REST 1

// -------------------------------- Sections --------------------------------------
SECT 2 MNO 1 TITL 'Decke'

POLY TYPE O
VERT '10' -0.5 0.15000000596046448
VERT '20' -0.5 -0.15000000596046448
VERT '30' 0.5 -0.15000000596046448
VERT '40' 0.5 0.15000000596046448
VERT '10' -0.5 0.15000000596046448

RF NO '100' Y -0.4699999988079071 Z 0.12000000476837158 LAY '1' MRF 101 TORS ACTI D 10
RF NO '101' Y -0.33571428060531616 Z 0.12000000476837158 LAY '1' MRF 101 TORS ACTI D 10
RF NO '102' Y -0.20142856240272522 Z 0.12000000476837158 LAY '1' MRF 101 TORS ACTI D 10
RF NO '103' Y -0.06714282929897308 Z 0.12000000476837158 LAY '1' MRF 101 TORS ACTI D 10
RF NO '104' Y 0.06714287400245667 Z 0.12000000476837158 LAY '1' MRF 101 TORS ACTI D 10
RF NO '105' Y 0.2014285773038864 Z 0.12000000476837158 LAY '1' MRF 101 TORS ACTI D 10
RF NO '106' Y 0.33571431040763855 Z 0.12000000476837158 LAY '1' MRF 101 TORS ACTI D 10
RF NO '107' Y 0.4699999988079071 Z 0.12000000476837158 LAY '1' MRF 101 TORS ACTI D 10
RF NO '200' Y -0.4699999988079071 Z -0.12000000476837158 LAY '2' MRF 101 TORS ACTI D 10
RF NO '201' Y -0.33571428060531616 Z -0.12000000476837158 LAY '2' MRF 101 TORS ACTI D 10
RF NO '202' Y -0.20142856240272522 Z -0.12000000476837158 LAY '2' MRF 101 TORS ACTI D 10
RF NO '203' Y -0.06714282929897308 Z -0.12000000476837158 LAY '2' MRF 101 TORS ACTI D 10
RF NO '204' Y 0.06714287400245667 Z -0.12000000476837158 LAY '2' MRF 101 TORS ACTI D 10
RF NO '205' Y 0.2014285773038864 Z -0.12000000476837158 LAY '2' MRF 101 TORS ACTI D 10
RF NO '206' Y 0.33571431040763855 Z -0.12000000476837158 LAY '2' MRF 101 TORS ACTI D 10
RF NO '207' Y 0.4699999988079071 Z -0.12000000476837158 LAY '2' MRF 101 TORS ACTI D 10

SECT 1 MNO 1 TITL 'Wand'

POLY TYPE O
VERT '10' -0.5 0.125
VERT '20' -0.5 -0.125
VERT '30' 0.5 -0.125
VERT '40' 0.5 0.125
VERT '10' -0.5 0.125

RF NO '100' Y -0.4749999940395355 Z 0.10000000149011612 LAY '1' MRF 101 TORS ACTI D 10
RF NO '101' Y -0.3392857015132904 Z 0.10000000149011612 LAY '1' MRF 101 TORS ACTI D 10
RF NO '102' Y -0.20357143878936768 Z 0.10000000894069672 LAY '1' MRF 101 TORS ACTI D 10
RF NO '103' Y -0.06785713136196136 Z 0.09999999403953552 LAY '1' MRF 101 TORS ACTI D 10
RF NO '104' Y 0.06785717606544495 Z 0.10000000149011612 LAY '1' MRF 101 TORS ACTI D 10
RF NO '105' Y 0.20357145369052887 Z 0.10000000149011612 LAY '1' MRF 101 TORS ACTI D 10
RF NO '106' Y 0.3392857015132904 Z 0.10000000149011612 LAY '1' MRF 101 TORS ACTI D 10
RF NO '107' Y 0.4749999940395355 Z 0.10000000149011612 LAY '1' MRF 101 TORS ACTI D 10
RF NO '200' Y -0.4749999940395355 Z -0.10000000149011612 LAY '2' MRF 101 TORS ACTI D 10
RF NO '201' Y -0.3392857015132904 Z -0.10000000149011612 LAY '2' MRF 101 TORS ACTI D 10
RF NO '202' Y -0.20357143878936768 Z -0.10000000894069672 LAY '2' MRF 101 TORS ACTI D 10
RF NO '203' Y -0.06785713136196136 Z -0.09999999403953552 LAY '2' MRF 101 TORS ACTI D 10
RF NO '204' Y 0.06785717606544495 Z -0.10000000149011612 LAY '2' MRF 101 TORS ACTI D 10
RF NO '205' Y 0.20357145369052887 Z -0.10000000149011612 LAY '2' MRF 101 TORS ACTI D 10
RF NO '206' Y 0.3392857015132904 Z -0.10000000149011612 LAY '2' MRF 101 TORS ACTI D 10
RF NO '207' Y 0.4749999940395355 Z -0.10000000149011612 LAY '2' MRF 101 TORS ACTI D 10

END

+PROG SOFIMSHC
HEAD Model
PAGE UNII 0
SYST 3D GDIR NEGZ GDIV -1000
CTRL INIT 7
CTRL TOLG 0.010000
CTRL MESH 1
CTRL HMIN 1.0000
CTRL TOPO XFLG 0
CTRL NODE 1000

// -------------------------------- Structural Elements ---------------------------

// ------------------------ Structural Points ---------------------
SPT 1 X 0.00000000 0.00000000 0.00000000 FIX PXPYPZMXMYMZ
SPT 2 X 0.00000000 0.00000000 3.15000000
SPT 3 X 3.00000000 0.00000000 3.15000000
SPT 4 X 6.00000000 0.00000000 3.15000000 FIX PZ

// ------------------------ Structural Lines ----------------------
SLN 101 GRP 1 SNO 1 DRX 0.000000 0.000000 -1.000000
 SLNB X1 0.00000000 0.00000000 0.00000000  X2 0.00000000 0.00000000 3.15000000
SLN 102 GRP 1 SNO 2 DRX 0.000000 0.000000 -1.000000
 SLNB X1 0.00000000 0.00000000 3.15000000  X2 3.00000000 0.00000000 3.15000000
SLN 103 GRP 1 SNO 2 DRX 0.000000 0.000000 -1.000000
 SLNB X1 3.00000000 0.00000000 3.15000000  X2 6.00000000 0.00000000 3.15000000

END

+PROG SOFILOAD
HEAD
PAGE UNII 0

// -------------------------------- Loads -----------------------------------------
LC 1 TYPE G FACD 1.000 TITL 'EGW'


LC 10 TYPE Q TITL 'Nutzlast'

POIN AUTO - TYPE PZZ -50.000000 X 3.000000 0.000000 3.150000

LC 20 TYPE W TITL 'Wind'

LINE AUTO - TYPE PZZ -0.800000 X1 0.000000 0.000000 3.150000 X2 3.000000 0.000000 3.150000
LINE AUTO - TYPE PZZ -0.800000 X1 3.000000 0.000000 3.150000 X2 6.000000 0.000000 3.150000

LC 30 TYPE S TITL 'Schnee'

LINE AUTO - TYPE PXX 1.000000 X1 0.000000 0.000000 0.000000 X2 0.000000 0.000000 3.150000

END

+PROG ASE
HEAD Berechnung
PAGE UNII 0

// -------------------------------- Loadcases -------------------------------------
LC 1
LC 10
LC 20
LC 30

END     
```


# Was fehlt noch?

Die Sofistik Komponenten Fokussieren sich derzeit auf die Modelerstellung und Lastdefinition, nicht aber die weiteren Schritte wie Überlagerung der Ergebnisse (Schnittgrößen) und der Bemessung.
Das kann aber leicht ergänzt werden.

Es gibt mehrere Wege:

- Text Block im Grasshopper ergänzt.
- Erstellten Code im Grasshopper als ein Bestandsteil im SSD (Sofistik Structural Desktop) nutzen und die restlichen Module im SSD ergänzen.

# Überlagerung


[SBB/1.Übung/Überlagerung](https://aiztok.github.io/SBB/011_Einfuehrungsbeispiel.html#%C3%BCberlagerung-der-ergebnisse)

# Bemessung


[SBB/1.Übung/Bemessung](https://aiztok.github.io/SBB/011_Einfuehrungsbeispiel.html#bemessung-der-stabelemente)


# Unterlagen

## Grasshopper File Analytisches Modell

Die GH Datei nur für die Definition des analytisches Modells kann [hier heruntergeladen](https://github.com/AIztok/DiTWP_Data/blob/main/212_UE/DiTWP_Rhino%26GH_analytisch.7z) werden.
Zip Datei mit:
- Bild
- .3dm Rhino Datei
- .gh Grasshopper Datei

## Excel File mit den Punkten 

Die exportierte Excel Datei kann hier [heruntergeladen werden](https://docs.google.com/spreadsheets/d/12tBpCPfz8VVdnAIc0UYua-GrliRCbfhP/edit?usp=sharing&ouid=107095587942628019482&rtpof=true&sd=true).

## Grasshopper File Sofistik Modell

Die GH Datei für die Definition in Sofistik (Einlesen über Speckle oder Import Excel) kann [hier heruntergeladen]() werden.









