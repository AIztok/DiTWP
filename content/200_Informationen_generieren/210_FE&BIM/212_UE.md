---
title: 212_Uebung
draft: false
tags:
  - "#FEM"
  - "#BIM"
---
# Was lernen wir?

- aus Geometriemodell das analytische Modell ableiten
- Export / Import Excel Datei und mit Speckle Dienst
- wir erstellen ein Stabmodell für den Halbrahmen
- wir ermitteln die Schnittgrößen für den Halbrahmen
- wir ergänzen noch fehlende Berechnungsschritte die nicht im Grasshopper als Sofistik Komponenten existieren 

# Aus Geometriemodell das analytische Modell ableiten

In der [[112_UE]] wurde ein 3D geometrisches Modell erstellt. 
Wir wollen jedoch für die Berechnung der Schnittgrößen der Konstruktion, das Bauwerk auf ein Stabmodell abstrahieren.
Dafür ist es notwendig ein s.g. analytisches Modell abzuleiten.

# Analytisches Modell ableiten

## BREPs zerlegen in Einzelteile

Wir sammeln die zwei BREPs in einem Datenkontainer und zerlegen dann diesen in die Einzelteile (Flächen, Linien, Punkte):

- `BREP` - als Datenkontainer für beider generierten BREPs (mit Flatten - siehe unten oder hier [[013_Grasshopper#Flatten]])
- `Deconstruct BREP` - um die Breps zu zerlegen in Einzelteile

![[Pasted image 20240901131146.png]]

Mit einem Rechtclick auf die Komponente kann die aufbereitung der Listen gesteuert werden. 
Z.B. mit Flatten wird der Baum (jeder BREP im einzelnen Baum) in einen Baum {0} verschoben

![[212_UE_GH_Flatten.png]]

## Linie im Schwerpunkt erstellen

Aus den Punkten der zerlegten BREPs bilden wir eine Linie in der Schwerpunktachse:

- `Fit Line` - für die Sammlung von Punkte bildet es eine Linie im "Schwerpunkt" der Punkte
- `Explode` - diese Linie wird dann explodiert in die Einzelteile (Punkt und Linien)
- `List Item` - wir wählen separat aus die Linie für die Decke bzw. die Wand

![[Pasted image 20240901131338.png]]

## Verschnitt Punkt der zwei Linien finden

Es fehlt uns nun ein Punkt, wo sich theoretisch die Linie der Decke und der Wand verschneiden würden:

- `Line / Line` - findet den Verschnittpunkt der zwei Linien - auch wenn die Linien sich nicht tatsächlich überschneiden sondern Ihre Verlängerung
- `Point` - danach sammeln wir alle Punkte im Datenkontainer

![[Pasted image 20240901131408.png]]

Verschnittpunkt:

![[Pasted image 20240901131434.png]]

# Export der Punktdaten in Excel Format

Damit wir den Workflow zeigen und auch das Modell von der .3dm Datei (Bild und gezeichnete Rechtecke aus der 1. Übung [[112_UE]]) zu trennen, werden wir die Geometrie exportieren in eine .xlsx Datei.

Um die Daten in .xlsx Dateiformat zu exportieren und später importieren, werden wir die Komponente vom TT-Toolbox verwenden.

Sollte bei der Übung die Installation nicht funktionieren oder andere Probleme geben, kann die Excel Datei heruntergeladen werden [[212_UE#Excel File mit den Punkten]].

## Export in Excel

Um die Punkte in eine Excel Datei zu exportieren gehen wie folgend vor:
- `Write to Excel classic` - Komponente aus der TT-Toolbox
- `Panel` - in den Panels definieren wir den Ort wohin wir die Excel Datei speichern wollen und in welches Arbeitsblatt (z.B. Tabelle 1) - wir nutzen hier `Concatenate` um zwei Strings (Ordner und Dateiname) separat zu definieren und zusammenzuführen
- `Boolean Toggle` - der boolische Schalter ist nur ein True / False, womit wir definieren ob die Funktion ausgeführt werden soll (True) und ob die existierenden Ergebnisse gelöscht werden sollen (False)

Wenn wir danach ein Panel anschließen, sehen wir, dass in den Zellen A1 bis E1 jetzt werden für die 5 Punkte gespeichert sein sollten - grundsätzlich sollte sich beim Ausführen auch das Excel öffnen. 

![[212_UE_Export_Excel.png]]

Danach speichern wir noch die Querschnittswerte (Breite und Abmessungen der Decke / Wände):

![[212_UE_Export-QS.png]]

Es wird somit eine .xlsx Datei mit folgenden Inhalt gespeichert (Hinweis: manchmal ist es notwendig eine leere Excel Datei mit gleichen Namen vorab zu erstellen):

<iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRfg0NANCaENZgN0bF01Z3zZYffYSIEtmzoIUA7ZUA6hdTTENOeoz1QWtdLMcHVzA/pubhtml?widget=true&amp;headers=false"></iframe>

Die Excel Datei könnte danach beliebig angepasst werden oder mit anderen geteilt werden. 
# Export der Daten des analytischen Modells (Punkte und Linien) auf Speckle 

Alternativ können wir das Modell auch über den Speckle Dienst teilen, der Vorteil wäre:
- es werden Linien und Punkte gleich exportiert
- es gibt eine interne Versionierung, also es werden bei mehrfachen Export Daten immer gespeichert und nicht überschrieben
- die exportierten Daten können im Browser visualisiert werden

Dafür ist es notwendig aber einen Account zu haben (siehe [[321_Speckle#Installieren]]) und bereits installierten Connector für Grasshopper.

## Beim Speckle Dienst Modell erstellen

Schritt 1: New Model - wir erstellen z.B. 212_ue
Schritt 2: bei 212_ue auf `...` gehen und "Copy link"

![[212_UE_Export_speckle.png]]

Mit "Copy link" wird ein Pfad erstellt, womit wir eine Verbindung zum Modell aufbauen können.
![[212_UE_speckle_copy_link.png|300]]

## Modell im Grasshopper mit Speckle stream verbinden

Wir verbinden die Punkte und Linien einfach mit einem Datenkontainer (`Data` ) und mit der Komponente `Send` von Speckle, danach Send auswählen:

![[212_UE_speckle_gh_send.png]]

Auf Speckle sollte das Modell danach sichtbar sein:

![[212_UE_speckle_model.png]]

Rechts oben im Browser kann auch der Link kopiert werden und mit anderen geteilt werden, bzw. das Modell kann in Grasshopper eingeladen werden:

> https://app.speckle.systems/projects/eba1405a21/models/84e2ea49f8

![[212_UE_speckle_share_link.png|300]]

<iframe title="Speckle" src="https://app.speckle.systems/projects/eba1405a21/models/84e2ea49f8#embed=%7B%22isEnabled%22%3Atrue%7D" width="600" height="400" frameborder="0"></iframe>

# Stabmodell erstellen

## Erstellen neue .GH Datei

Wir erstellen im gleichen Ordner eine neue Grasshopper Datei:

![[212_UE_new_document.png]]


## Einlesen Modell aus Speckle

Wir lesen mit der Komponente:
`Receive` von Speckle
die Daten die wir vorher exportiert haben ein und teilen aus auf mit `List Item` auf Punkte und Linien

> https://app.speckle.systems/projects/eba1405a21/models/84e2ea49f8

![[212_UE_receive_speckle.png]]

Sollte das Einlesen nicht funktionieren, dann hier die Daten die in ein Panel einkopiert werden können für Punkte, Linien müssen dann manuell erstellt werden:
```
{0.15, 0.5, 3.15}
{0.15, 0.5, 0}
{0, 0.5, 3.3}
{6, 0.5, 3.3}
{0.15, 0.5, 3.3}
```

## Erstellung Strukturpunkte

Die Strukturpunkte werden mit der Sofistik Komponente :
`Structural Points` erstellt

Für die Nummerierung der Punkte nutzen wird die Komponente:
`Series`

Die Auflagerdefinitionen sind Sofistik intern:
F - fix
PZ - Auflager in Z Richtung

![[212_UE_structural_points.png]]
 
## Erstellung Strukturlinien

Die Strukturlinien werden sehr ähnlich erstellt mit der Sofistik Komponente
`Structural Line`

![[212_UE_structural_lines.png]]
## Erstellung Kopplung

Zwischen der Linie der Decke und der Wand gibt es einen Spalt, hier werden die Knoten mit einer Kopplung verbunden, Sofistik Komponente `Rigid Link`

![[212_UE_couplings.png]]

## Erstellung Sofistik Eingabe Datei fürs Modell

Wenn wir alle drei Komponenten (Structural Points, Structural Lines und Rigid Link) mit einem Datencontainer verbinden, können wir dann mit der Sofistik Komponente `SOFIMSHC` die Eingabe in Text (Cadinp Programmiersprache in Sofistik) erstellen. 
Mit der Komponente `Text File` kann dann dieser Text in eine .dat (ASCII) Datei gespeichert werden.

![[212_UE_sofimshc.png]]

Der erstellte Code:

```python
+PROG SOFIMSHC
HEAD Model
PAGE UNII 0
SYST 3D GDIR NEGZ GDIV -1000
CTRL INIT 7
CTRL TOLG 0.010000
CTRL MESH 1
CTRL HMIN 1.0000
CTRL TOPO XFLG 0
CTRL NODE 1000

// -------------------------------- Structural Elements ---------------------------

// ------------------------ Structural Points ---------------------
SPT 1 X 0.15000000 0.50000000 3.15000000
 SPTP PXPYPZMXMYMZ REF 5
SPT 2 X 0.15000000 0.50000000 0.00000000 FIX PXPYPZMXMYMZ
SPT 3 X 0.00000000 0.50000000 3.30000000
SPT 4 X 6.00000000 0.50000000 3.30000000 FIX PZ
SPT 5 X 0.15000000 0.50000000 3.30000000

// ------------------------ Structural Lines ----------------------
SLN 101 GRP 1 SNO 1 DRX 0.000000 0.000000 -1.000000
 SLNB X1 -0.00000000 0.50000000 3.30000000  X2 6.00000000 0.50000000 3.30000000
SLN 102 GRP 1 SNO 2 DRX 0.000000 0.000000 -1.000000
 SLNB X1 0.15000000 0.50000000 3.15000000  X2 0.15000000 0.50000000 0.00000000

END     
```

# Definition der Lasten

## Eigengewicht

Für das Eigengewicht benötigen wir keine Kraft angeben, nur die Linien auswählen und die Lastfallnummer. Der Faktor für Eigengewicht wird später definiert, siehe [[212_UE#Lastfall Attribute]].

![[Pasted image 20240617222943.png]]


## Veränderliche Lasten

### Nutzlast
Die Nutzlast wird als eine Punktlast mit 50 kN, die am Punkt in der Mitte der Linie (Decke) wirkt wie folgend definiert, wir beziehen uns dabei mit der Komponente `Point on line` auf die Mitte (0,5 * Länge) der Linie:

![[212_UE_nutzlast_.png]]

### Schneelast
Die Schneelast wird als eine Linienlast aufgebracht, dabei können mehrere Linien ausgewählt werden:

![[212_UE_schneelast.png]]
### Windlast
Ähnlich auch die Windlast, jedoch wirkend auf die Linie 1 und in X Richtung:

![[212_UE_windlast.png]]
## Lastfall Attribute

Die Lastfallnummern werden in den Komponente LC Attributes.
Hier wird auch definiert:
- Einwirkung 
- Faktor für das Eigengewicht
- Bezeichnung

Die Lastfallnummern werden dabei aus den oben angegebenen Lastfallnummern in eine Liste zusammengeführt. In gleicher Reihenfolge sollten die Einwirkungsarten und Faktoren fürs Eigengewicht definiert werden, damit richtig zugewiesen:

![[Pasted image 20240617223303.png]]

## Erstellung SOFiLOAD Input

Die Einzellastfälle und die Lastfall Attribute werden mit der Komponente SOFiLOAD verbunden um den Input für das Modul SOFiLOAD zu erstellen:

![[Pasted image 20240617223609.png]]

Auch hier speichern wir die Eingabe Datei in eine .dat:

![[212_UE_sofiload.png]]



```python
+PROG SOFILOAD
HEAD
PAGE UNII 0

// -------------------------------- Loads -----------------------------------------
LC 1 TYPE G FACD 1.000 TITL 'EGW'


LC 10 TYPE Q TITL 'Nutzlast'

POIN AUTO - TYPE PZZ -50.000000 X 3.000000 0.500000 3.300000

LC 20 TYPE W TITL 'Wind'

LINE AUTO - TYPE PZZ -0.800000 X1 -0.000000 0.500000 3.300000 X2 6.000000 0.500000 3.300000

LC 30 TYPE S TITL 'Schnee'

LINE AUTO - TYPE PXX 1.000000 X1 0.150000 0.500000 3.150000 X2 0.150000 0.500000 0.000000

END  
```

# Schnittgrößenermittlung
Die Schnittgrößenermittlung / Berechnung erfolgt mit dem Programm ASE, dafür wird auch hier die Eingabedatei erstellt:

![[212_UE_ase.png]]

Der erstellte Code:

```python
+PROG ASE
HEAD Berechnung
PAGE UNII 0

// -------------------------------- Loadcases -------------------------------------
LC 1
LC 10
LC 20
LC 30

END     
```

# Was fehlt noch?

Die Sofistik Komponenten Fokussieren sich derzeit auf die Modelerstellung und Lastdefinition, nicht aber die weiteren Schritte wie Überlagerung der Ergebnisse (Schnittgrößen) und der Bemessung.
Das kann aber leicht ergänzt werden.

Es gibt mehrere Wege:

- Text Block im Grasshopper ergänzt.
- Erstellten Code im Grasshopper als ein Bestandsteil im SSD (Sofistik Structural Desktop) nutzen und die restlichen Module im SSD ergänzen.

# Einlesen in den Sofistik SSD

## SSD



Die einzelnen Komponenten die den Text Input in Cadinp erstellen, werden mit der SOFiSTiK Project Komponente verbunden. Dabei muss auf die Reihenfolge der anbindung geachtet werden:
1. Material (AQUA)
2. Querschnitte (AQUA)
3. Modell (SOFiMSHC)
4. Lasten (SOFiLOAD)
5. Berechnung (ASE)

## Materialdefinition


## Querschnittsdefinition


## Modell

## Definition der Einwirkungen


## Lasten


## Berechnung



## Überlagerung


[SBB/1.Übung/Überlagerung](https://aiztok.github.io/SBB/011_Einfuehrungsbeispiel.html#%C3%BCberlagerung-der-ergebnisse)

## Bemessung


[SBB/1.Übung/Bemessung](https://aiztok.github.io/SBB/011_Einfuehrungsbeispiel.html#bemessung-der-stabelemente)


# Unterlagen

## Grasshopper File Analytisches Modell

Die GH Datei nur für die Definition des analytisches Modells kann [hier heruntergeladen](https://github.com/AIztok/DiTWP_Data/blob/main/212_UE/DiTWP_Rhino%26GH_analytisch.7z) werden.
Zip Datei mit:
- Bild
- .3dm Rhino Datei
- .gh Grasshopper Datei

## Excel File mit den Punkten 

Die exportierte Excel Datei kann hier [heruntergeladen werden](https://docs.google.com/spreadsheets/d/12tBpCPfz8VVdnAIc0UYua-GrliRCbfhP/edit?usp=sharing&ouid=107095587942628019482&rtpof=true&sd=true).

## Vorlagedatei für SSD Sofistik (.sofistix)

Die Sofistix Datei kann hier [heruntergeladen werden](https://github.com/AIztok/DiTWP_Data/blob/main/212_UE/FH_SBB_SSD-Vorlage_V01.sofistix).

## Grasshopper File Sofistik Modell

Die GH Datei für die Definition in Sofistik (Einlesen über Speckle oder Import Excel) kann [hier heruntergeladen](https://github.com/AIztok/DiTWP_Data/blob/main/212_UE/DiTWP_GH_Analytisch-Sofi.7z) werden.
Zip Datei mit:
- DiTWP_GH_Analytisch-SOFi.gh
- DiTWP_212-UE_Punkte.xlsx - Excel Datei die gelesen wird in Sofistik
- DiTWP-212-UE.sofistik - Eingabedatei für SSD
- DiTWP_212-UE.cdb - Datenbasis des Models
- ASE.dat, Sofiload.dat, Sofimshc.dat - Eingabedateien erstellt mit Grasshopper Sofistik Komponenten









